<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>IA Chess</title>
</head>
  <script src="pixi/pixi.min.js"></script>
<body>
  <script type="text/javascript">
    let type = "WebGL"
    if(!PIXI.utils.isWebGLSupported()){
      type = "canvas"
    }

    PIXI.utils.sayHello(type)


    //Create a Pixi Application
    let app = new PIXI.Application({ 
        width: 856,         // default: 800
        height: 856,        // default: 600
        antialias: false,    // default: false
        transparent: false, // default: false
        resolution: 0.9      // default: 1
    });


    //Add the canvas that Pixi automatically created for you to the HTML document
    document.body.appendChild(app.view);

    //load an image and run the `setup` function when it's done
    PIXI.loader
    .add(["./resources/board/107.png",
          "./resources/pieces/bb.png",
          "./resources/pieces/bk.png",
          "./resources/pieces/bn.png",
          "./resources/pieces/bp.png",
          "./resources/pieces/bq.png",
          "./resources/pieces/br.png",
          "./resources/pieces/wb.png",
          "./resources/pieces/wk.png",
          "./resources/pieces/wn.png",
          "./resources/pieces/wp.png",
          "./resources/pieces/wq.png",
          "./resources/pieces/wr.png",
    ])
    .load(setup);

    let blackPieces = ["br", "bn", "bb"];
    let whitePieces = ["wr", "wn", "wb"];
    let pieces = {}
    var selectedPiece;
    function onDown(eventData, piece) {
        console.log(eventData.data.global.x);
        console.log(eventData.data.global.y);
        pieces[piece].position.set(eventData.x, eventData.y);
    }

    //This `setup` function will run when the image has loaded
    function setup() {
        let board = new PIXI.Sprite(PIXI.loader.resources["./resources/board/107.png"].texture);
        app.stage.addChild(board);
        // black pieces
        for (var i = 0; i < blackPieces.length; ++i) {
            pieces[blackPieces[i]+"1"] = new PIXI.Sprite(PIXI.loader.resources["./resources/pieces/"+blackPieces[i]+".png"].texture);
            pieces[blackPieces[i]+"2"] = new PIXI.Sprite(PIXI.loader.resources["./resources/pieces/"+blackPieces[i]+".png"].texture);
            pieces[blackPieces[i]+"1"].position.set(i*107, 0);
            pieces[blackPieces[i]+"2"].position.set((7-i)*107, 0);
            app.stage.addChild(pieces[blackPieces[i]+"1"]);
            app.stage.addChild(pieces[blackPieces[i]+"2"]);
        }
        for (var i = 0; i < 8; ++i) {
            pieces["bp"] = new PIXI.Sprite(PIXI.loader.resources["./resources/pieces/bp.png"].texture);
            pieces["bp"].position.set(i*107, 107);
            app.stage.addChild(pieces["bp"]);
        }
        pieces["bq"] = new PIXI.Sprite(PIXI.loader.resources["./resources/pieces/bq.png"].texture);
        pieces["bq"].position.set(3*107, 0);
        app.stage.addChild(pieces["bq"]);
        pieces["bk"] = new PIXI.Sprite(PIXI.loader.resources["./resources/pieces/bk.png"].texture);
        pieces["bk"].position.set(4*107, 0);
        app.stage.addChild(pieces["bk"]);

        // white pieces
        for (var i = 0; i < whitePieces.length; ++i) {
            pieces[whitePieces[i]+"1"] = new PIXI.Sprite(PIXI.loader.resources["./resources/pieces/"+whitePieces[i]+".png"].texture);
            pieces[whitePieces[i]+"2"] = new PIXI.Sprite(PIXI.loader.resources["./resources/pieces/"+whitePieces[i]+".png"].texture);
            pieces[whitePieces[i]+"1"].position.set(i*107, 7*107);
            pieces[whitePieces[i]+"2"].position.set((7-i)*107, 7*107);
            app.stage.addChild(pieces[whitePieces[i]+"1"]);
            app.stage.addChild(pieces[whitePieces[i]+"2"]);
        }
        for (var i = 0; i < 8; ++i) {
            pieces["wp"] = new PIXI.Sprite(PIXI.loader.resources["./resources/pieces/wp.png"].texture);
            pieces["wp"].position.set(i*107, 6*107);
            app.stage.addChild(pieces["wp"]);
        }
        pieces["wq"] = new PIXI.Sprite(PIXI.loader.resources["./resources/pieces/wq.png"].texture);
        pieces["wq"].position.set(3*107, 7*107);
        app.stage.addChild(pieces["wq"]);
        pieces["wk"] = new PIXI.Sprite(PIXI.loader.resources["./resources/pieces/wk.png"].texture);
        pieces["wk"].position.set(4*107, 7*107);
        pieces["wk"].interactive = true;
        pieces["wk"].on('mousedown', function(eventData) {selectedPiece = "wk"});
        app.stage.addChild(pieces["wk"]);
    }


  </script>
</body>
</html>